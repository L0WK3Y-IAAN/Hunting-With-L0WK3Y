# Android 04

<aside>

## The Challenge

This application requires a PIN code to provide you with the key. However, without knowing the PIN, you will not be able to retrieve the key.

There are two ways to get around this:

- The first way is to use [**apktool**](https://ibotpeaches.github.io/Apktool/) like you did before. **`apktool`** will extract the application's code as **`Smali`** code. Then you will be able to browse the source code in the **`Smali`** directory (it's not very intuitive, however, it's enough to solve this exercise).
- The second way is to extract the application yourself using **`unzip`**. From there, you should see a file named **`classes.dex`**. You can then use the tool [**dex2jar**](https://sourceforge.net/projects/dex2jar/) to convert the **`dex`** file to a **`jar`** file. Once this is done, you can either **`unzip`** the **`jar`** file to browse the code or use [**jd-gui**](https://github.com/java-decompiler/jd-gui/releases).

By inspecting the **`Smali`** code or the **`Java`** code, you should be able to find how the key has been "encrypted". It's actually a **`XOR`** between the key and a single character. You can easily retrieve the key by applying the same operation to the encrypted text.

</aside>

For the fourth challenge, there is a line that calls the class and method `SecureStorage.decrypt` and is given a Unicode-escaped string with an XOR key of 52 bytes (0x34).

```jsx
showMessage("The key is: \n" + SecureStorage.decrypt("\u0005\u0006\u0006\u0003U\u0001UU\u0019WQ\f\u0006\u0019\u0000PU\f\u0019\rVU\u0002\u0019W\u0000\rQ\f\u0004\rVU\u0003\u0006\u0004", (byte) 52));
```

```jsx
public static String decrypt(String str, byte b) {
        byte[] bytes = str.getBytes();
        byte[] bArr = new byte[bytes.length];
        for (int i = 0; i < bytes.length; i++) {
            bArr[i] = (byte) (bytes[i] ^ b);
        }
        return new String(bArr);
    }
```

If you take the Unicode-escaped string and unescape the characters then XOR it with the key, you will get the flag.

![image.png](Android%204/image.png)
---
<div class="banner-container">
        <div class="left-panel">
            <div class="card">
                <h2>Let's Connect!</h2>
                <div class="social-links">
                    <a href="https://github.com/L0WK3Y-IAAN" target="_blank">
                        <img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white" alt="GitHub">
                    </a>
                    <a href="https://www.linkedin.com/in/iaansec/" target="_blank">
                        <img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn">
                    </a>
                </div>
            </div>
        </div>
    </div>
