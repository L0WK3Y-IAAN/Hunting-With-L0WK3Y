# Android 05

<aside>

## **The Challenge**

This application requires a PIN code to provide you with the key. However, without knowing the PIN, you will not be able to retrieve the key.

There are two ways to get around this:

- The first way is to use [**apktool**](https://ibotpeaches.github.io/Apktool/) like you did before. **`apktool`** will extract the application's code as **`Smali`** code. Then you will be able to browse the source code in the **`Smali`** directory (it's not very intuitive, however, it's enough to solve this exercise).
- The second way is to extract the application yourself using **`unzip`**. From there, you should see a file named **`classes.dex`**. You can then use the tool [**dex2jar**](https://sourceforge.net/projects/dex2jar/) to convert the **`dex`** file to a **`jar`** file. Once this is done, you can either **`unzip`** the **`jar`** file to browse the code or use [**jd-gui**](https://github.com/java-decompiler/jd-gui/releases).

This time the code has been minimised using [**ProGuard**](https://en.wikipedia.org/wiki/ProGuard_(software)). This makes reversing the application more complex.

By inspecting the **`Smali`** code or the **`Java`** code, you should be able to find how the key has been "encrypted". It's actually a **`XOR`** between the key and a string. You can easily retrieve the key by applying the same operation to the encrypted text.

</aside>

In the `onCreate` of `MessageActivity` there is another Unicode-escaped string but this time contains escape characters such as **`\r`**  carriage return and **`\\`**  single backslash. This string is then XOR’d against the key assigned to the variable `decryption_key` located in Resources → Strings.

```jsx
    protected void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.message);
        this.l = (TextView) findViewById(R.id.message);
        getIntent().getExtras().getString("pin");
        a("The key is: \n" + a.a("i]\rD\u0004\u0015\u0017\u0004_~\u0002\u0006`HZ@UBY\\Ku\u0002O2\u0003_MQB\u0010\u0007G~\u0004Q", getString(R.string.decryption_key)));
    }
```

![image.png](Android%205/image.png)

![image.png](Android%205/image%201.png)